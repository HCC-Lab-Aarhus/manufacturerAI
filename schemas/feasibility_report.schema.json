{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "FeasibilityReport",
  "description": "Output of Feasibility Tool - DRC-style check with actionable fixes",
  "type": "object",
  "required": ["feasible", "checks", "errors", "warnings"],
  "properties": {
    "feasible": {
      "type": "boolean",
      "description": "Overall pass/fail"
    },
    "checks": {
      "type": "object",
      "description": "Summary of checks performed",
      "properties": {
        "component_overlap": {"type": "boolean"},
        "edge_clearance": {"type": "boolean"},
        "button_spacing": {"type": "boolean"},
        "board_dimensions": {"type": "boolean"}
      }
    },
    "errors": {
      "type": "array",
      "description": "Critical issues that prevent manufacturing",
      "items": {
        "type": "object",
        "required": ["code", "message", "affected_entities"],
        "properties": {
          "code": {
            "type": "string",
            "enum": [
              "COMPONENT_OVERLAP",
              "EDGE_CLEARANCE_VIOLATION",
              "BUTTON_SPACING_VIOLATION",
              "BOARD_TOO_SMALL",
              "KEEPOUT_OVERLAP",
              "INVALID_FOOTPRINT"
            ]
          },
          "message": {
            "type": "string",
            "description": "Human-readable error message"
          },
          "affected_entities": {
            "type": "array",
            "items": {"type": "string"},
            "description": "Component IDs or board objects involved"
          },
          "measured_value": {
            "type": "number",
            "description": "Actual measured value (e.g., clearance in mm)"
          },
          "required_value": {
            "type": "number",
            "description": "Required minimum/maximum value"
          },
          "suggested_fixes": {
            "type": "array",
            "description": "Machine-actionable fix operations",
            "items": {
              "type": "object",
              "required": ["operation"],
              "properties": {
                "operation": {
                  "type": "string",
                  "enum": ["translate", "resize_board", "swap_footprint", "remove_component", "adjust_spacing"]
                },
                "id": {
                  "type": "string",
                  "description": "Component/object ID to modify"
                },
                "dx": {
                  "type": "number",
                  "description": "Translation in X (mm)"
                },
                "dy": {
                  "type": "number",
                  "description": "Translation in Y (mm)"
                },
                "new_width": {"type": "number"},
                "new_height": {"type": "number"},
                "new_footprint": {"type": "string"}
              }
            }
          }
        }
      }
    },
    "warnings": {
      "type": "array",
      "description": "Non-critical issues",
      "items": {
        "type": "object",
        "required": ["code", "message"],
        "properties": {
          "code": {"type": "string"},
          "message": {"type": "string"},
          "affected_entities": {
            "type": "array",
            "items": {"type": "string"}
          }
        }
      }
    },
    "statistics": {
      "type": "object",
      "description": "Summary statistics",
      "properties": {
        "total_components": {"type": "integer"},
        "board_utilization_percent": {"type": "number"},
        "min_clearance_found_mm": {"type": "number"}
      }
    }
  }
}
